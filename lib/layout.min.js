!function(e,t){var r="undefined"!=typeof global?global:window,n=r.mask||r.atma&&r.atma.mask;if(null==n)throw Error("MaskJS was not loaded");t(r,n)}(this,function(e,t){"use strict";var r,n=function(e){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){return e.setTimeout(t,1e3/60)}}(e),i={"-moz-box-sizing":"border-box","box-sizing":"border-box"};!function(){r=function(e){throw new Error("[Layout Component] "+e)}}();var o,s,l;!function(){function e(e,t,r){return null==r||""===r?e:(e||"")+";"+t+":"+r}o=function(e,r){return{tagName:"div",type:t.Dom.NODE,nodes:e,attr:r}},s=function(t,r,n){if(null!=r){var i=t.attr.style;if("string"==typeof r)i=e(i,r,n);else for(var o in r)i=e(i,o,r[o]);t.attr.style=i}},l=function(e,t){var r=e.attr.style;e.attr.style=(r||"")+";"+t}}();var a,u,f;!function(){function e(e,t,r){null!=r&&e.style.setProperty(t,r)}a=function(t,r,n){if(null!=r){if("string"==typeof r)return void e(t,r,n);for(var i in r)e(t,i,r[i])}},u=function(e,t){var r=e.getAttribute("style");e.setAttribute("style",r+";"+t)},f=function(e){return null!=e&&1===e.nodeType}}();var h,c;!function(){h=function(e,t){if(null==e||"object"!=typeof e)return[];if("number"!=typeof e.length)return[t(e,0)];for(var r=e.length,n=0,i=new Array(r);r>n;n++)i[n]=t(e[n],n);return i},c=function(e,t){for(var r=e.length,n=0;r>n;n++)t(e[n],n)}}();var p;!function(){p=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];null==e&&(e={});for(var n,i=t.length,o=0;i>o;o++)if(n=t[o],null!=n)for(var s in n)e[s]=n[s];return e}}();var d;!function(){d=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.pop();null==r&&(r={});for(var n,i,o,s=r.hasOwnProperty("constructor")?r.constructor:null,l=e.length;--l>-1;){i=e[l],"function"==typeof i&&(null==s&&null==n&&(n=i),i=i.prototype);for(var a in i)null==r[a]&&(r[a]=i[a]);null==o&&(o=i)}return r.Parent=o,null==s&&(s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n?n.apply(this,e):void 0}),s.prototype=r,s}}();var v,m,w;!function(){v=function(e,t,r,n,i){for(3===arguments.length&&(n=0,i=e.length);i>n;n++){var o=_.parseType(e[n].attr[t]);if(o===r)return!0}return!1},m=function(e,t,r,n){2===arguments.length&&(r=0,n=e.length);var i,s,l;for(i=r;n>i;i++)if(l=new _(e[i].attr[t]),null!=s){if(s.type!==l.type){s.type="auto";break}s.value+=l.value}else s=l;var a=o(e.slice(r,n),{});return a.attr[t]=String(s),a},w=function(e,t,r){var n=e.attr,i=n[t],o=n["min-"+t],l=n["max-"+t],a=n.overflow;return"flex"!==i&&s(e,t,i),s(e,"min-"+t,o),s(e,"max-"+t,l),s(e,"overflow",a),s(e,r),null!=i&&(n[t]=null),null!=o&&(n["min-"+t]=null),null!=l&&(n["max-"+t]=null),null!=a&&(n.overflow=null),null==i&&(i="flex"),{size:i,min:o,max:l,overflow:a}}}();var g,y;!function(){function e(e){var n;if(!e)return r;for(var i,o,s,l,a=t.length,u=0;a>u;u++)if(n=t[u],i=n[0],o=n[1],l=n[2],n,-1!==e.indexOf(i)){if(null==l)return{browser:o};var f=l.exec(e);return f&&f.length>1&&(s=parseFloat(f[1])),{browser:o,version:s||0}}return r}g=function(t){var r=t&&t.req&&t.req.headers?t.req.headers["User-Agent"]:navigator.userAgent;return e(r)},y=e;var t=[["bot","bot"],["Opera","opera",/Version\/? ?(\d+(\.\d+)*)/],["MSIE","ie",/MSIE (\d+(\.\d+)*)/],["Android","android",/Android ?(\d+(\.\d+)*)/],["BlackBerry","blackberry",/Version\/? ?(\d+(\.\d+)*)/],["Firefox","firefox",/Firefox\/(\d+(\.\d+)*)/],["Chrome","chrome",/Chrome\/(\d+(\.\d+)*)/],["Safari","safari",/Version\/(\d+(\.\d+)*)/],["rv:","ie",/rv:(\d+(\.\d+)*)/]],r={browser:"unknown",version:0}}();var x,b,k,z;!function(){x=function(t){var r=g(t),n=e[r.browser];return n===!0?!0:n<=r.version},b=function(){var e=void 0!==arguments[0]?arguments[0]:"row";return"display: -webkit-flex; display: flex; -webkit-flex-direction: "+e+"; flex-direction: "+e},k=function(){var e=void 0!==arguments[0]?arguments[0]:1;return"-webkit-flex: "+e+"; flex: "+e},z=function(e,t){var r=e,n={};return"visible"===t&&(r="min-"+r),n[r]="100%",n};var e={bot:!0,ie:11,firefox:28,chrome:21,safari:7,opera:12.1,blackberry:10,android:4.4}}();var B;!function(){function e(){var e,r=t.length;for(e=0;r>e;e++)t[e].checkReflowRequired();for(e=0;r>e;e++)t[e].reflow()}var t=[];B={register:function(e){null!=e&&(t.unshift(e),r())},unregister:function(e){if(null!=e){var r=listeners_.indexOf(e);-1!==r&&t.splice(r,1)}}};var r;!function(){function t(){i||(i=!0,n(function(){i=!1,e()}))}r=function(){r=function(){},window.addEventListener("resize",t,!1)};var i=!1}()}(),function(){function e(e,t,r){return null==r?o(t,{style:e}):(r.style=r.style?r.style+";"+e:e,o(t,r))}t.registerHandler("l:center",{renderStart:function(){this.nodes=e("display: table; height: 100%; width: 100%; overflow: auto",e("display: table-cell; vertical-align: middle",e("margin: 0 auto",this.nodes,this.attr)))}})}();var _;!function(){_=function(e){this.type=_.parseType(e),("px"===this.type||"%"===this.type)&&(this.value=parseFloat(e))},_.prototype={type:"flex|auto|px|%",value:null,toString:function(){switch(this.type){case"px":case"%":return this.value+this.type;case"auto":return"auto";default:return null}}},_.parseType=function(e){return null==e||"flex"===e?"flex":"auto"===e?e:-1!==e.indexOf("px")?"px":-1!==e.indexOf("%")?"%":void r("Invalid size value "+e)}}();var C,A,S;!function(){C=function(e,t){this.size=new _(t.size),this.overflow=t.overflow,this.element=e},C.prototype={element:null,name:"Width|Height",css:"width|height",overflow:"auto|scroll|visible",size:null,offsetBefore:null,offsetAfter:null,isFlex:function(){return"flex"===this.size.type},ensureStrict:function(e,t,r,n){this.offsetBefore=n;var i=this.size.value;switch(this.size.type){case"px":return i;case"%":return r*i/100;case"auto":return null==i&&(i=this.size.value=this.offsetSize()),i}throw Error("Unsupported type: "+this.size.type)},ensureFlex:function(e,t,r,n,i){if(this.offsetBefore=i,"visible"!==this.overflow)return this.size.value=e,this.element.style[this.css]=e+"px",0;this.size.value=e,this.element.style["min-height"]=e+"px";var o=this.offsetSize()-e;return 0>o?0:o},dispose:function(){this.element=null},offsetSize:function(){return this.element["offset"+this.name]},scrollSize:function(){return this.element["scroll"+this.name]},setCss:function(e,t){return a(this.element,e,t),this}},A={ensureStrict:function(e,t,r,n,i){var o="before"===i?this.cssBefore:this.cssAfter;return n!==this.offsetBefore&&(this.element.style[o]=n+"px"),C.prototype.ensureStrict.call(this,e,t,r,n)},ensureFlex:function(e,t,r,n,i,o){var s=this.element.style;return i!==this.offsetBefore&&(s[this.cssBefore]=(this.offsetBefore=i)+"px"),o!==this.offsetAfter&&(s[this.cssAfter]=(this.offsetAfter=o)+"px"),o-i}},S={ensureStrict:function(e,t,r,n,i){if("after"===i){var o=this.element["offset"+this.name];a(this.element,"margin-"+this.cssBefore,"-"+o+"px")}return C.prototype.ensureStrict.call(this,e,t,r,n)},ensureFlex:function(e,t,r,n,i,o){return this.offsetBefore!==i&&((null!=this.offsetBefore||0!==i)&&this.setCss("margin-"+this.cssBefore,"-"+i+"px").setCss("padding-"+this.cssBefore,i+"px"),this.offsetBefore=i),this.offsetAfter!==o&&((null!=this.offsetAfter||0!==o)&&this.setCss("padding-"+this.cssAfter,o+"px"),this.offsetAfter=o),o-i}}}();var F,E,R;!function(){F=d({constructor:function(e,t,r){this.nodes=e,this.metas=t},beforeCount:0,afterCount:0,performLayout:function(){for(var e,t=this.metas.length,r={before:{value:0,unit:"px"},after:{value:0,unit:"px"}},n=null,i="before",o=0;t>o;o++)if(e=new _(this.metas[o].size),"flex"!==e.type){this[i+"Count"]+=1;var s=r[i];this.setStrict(this.nodes[o],this.metas[o],s.value+s.unit,i),s.unit=e.type,s.value+=e.value}else n=o,i="after";this.setFlex(this.nodes[n],this.metas[n],r.before.value+r.before.unit,r.after.value+r.after.unit)},requiresDomController:function(){for(var e,t=this.metas.length,r=0,n="before",i=null;t>r;r++)if(e=_.parseType(this.metas[r].size),"flex"!==e){if("auto"===e)return!0;if(null!=i){if(i!==e)return!0}else i=e}else{if("after"===n)return!0;n="after",i=null}return!1},nodes:null,metas:null}),F.prepairBlockMetas=function(e,t,r){return h(e,function(e){return w(e,t,r)})},E=d(F,{cssBefore:null,cssAfter:null,setStrict:function(e,t,r,n){var i="before"===n?this.cssBefore:this.cssAfter;s(e,i,r)},setFlex:function(e,t,r,n){var i={};i[this.cssBefore]=r,i[this.cssAfter]=n,s(e,i)}}),R=d(F,{cssMargin:"margin-top|margin-left",setStrict:function(e,t,r,n){"after"===n&&(s(e,this.css,t.size),s(e,this.cssMargin,"-"+t.size))},setFlex:function(e,t,r,n){var i={};0!==this.beforeCount&&(i["margin-"+this.cssBefore]="-"+r,i["padding-"+this.cssBefore]=r),0!==this.afterCount&&(i["padding-"+this.cssAfter]=n),s(e,i)}})}();var N;!function(){function e(e,t){var r=e.attr[t];return null==r||"flex"===r}function t(e,t,r,n,i){var o=m(e,t,r,n);return c(o.nodes,function(e){return w(e,t)}),s(o,i),e.splice(r,n-r,o),o}function r(e,t,r,n,i){var o=n-r;if(0===o)return null;var l=e[r];return s(l,i),l}N={wrapFlexBlocks:function(t,n,i,l,a){var u,f,h,c=t.length;for(u=0;c>u&&!e(t[u],n);u++);for(f=u,u=c-1;u>f&&!e(t[u],n);u--);h=++u;var p=null,d=h-f;return 2>d?r(t,n,f,h,a):(p=o(t.splice(f,d),{}),this.shareSpace(p.nodes,n,i,l),s(p,a),t.splice(f,0,p),p)},wrapBefore:function(n,i,o){var s,l=n.length;for(s=0;l>s&&!e(n[s],i);s++);return 2>s?r(n,i,0,s,o):(l=s,t(n,i,0,l,o))},wrapAfter:function(n,i,o){var s,l=n.length;for(s=l-1;s>-1&&!e(n[s],i);s--);return s>=l-2?r(n,i,s+1,l,o):t(n,i,s+1,l,o)},shareSpace:function(e,t,r,n){var i=0,o=100/e.length;c(e,function(e){var a=t;"visible"===e.attr.overflow?a="min-"+a:l(e,"overflow: auto"),s(e,a,o+"%"),s(e,r,i+"%"),s(e,n),i+=o})}}}();var q,M={tagName:"div",type:"width|height",layout:null,resizerType:"dynamic",attr:{overflow:"auto"},slots:{domInsert:function(){null!=this.layout&&(this.layout.ensureElement(),this.layout.checkReflowRequired(),this.layout.reflow())},layout_Recalculate:function(){return this.layout.checkReflowRequired()},layout_Reflow:function(){this.layout.reflow()}},renderStart:function(){this.handleAttr_(),this.handleExpression_();var e=this.prepairBlocks_();null==e?this.slots=null:this.scope={$blocks:e}},renderEnd:function(e,t,r,n){var i=this.scope&&this.scope.$blocks;if(null!=i){var o=this.resolveElements(e,t,r,n),s=o[0],l=o[1];this.layout=new this.LayoutController(s,l,i,this.attr),"dynamic"===this.resizerType&&B.register(this.layout)}},resolveElements:function(e){var t=e[0],r=Array.prototype.slice.call(t.childNodes);return[t,r]},dispose:function(){null!=this.layout&&(this.layout.dispose(),B.unregister(this.layout))},handleExpression_:function(){if(null!=this.expression){var e=this,t=e.nodes,r=e.type,n=e.expression,i=n.split(-1===n.indexOf(",")?" ":",");if(i.length!==t.length)throw Error("Expression for "+i.length+", but expected for "+t.length+" elements. "+n);c(t,function(e,t){return e.attr[r]=i[t].trim()})}},handleAttr_:function(){var e="width: 100%",t="height: 100%";"visible"===this.attr.overflow&&(e="min-"+e,t="min-"+t),l(this,e+";"+t)}},H={attr:{overflow:"visible"},handleAttr_:function(){this.tagName=null},resolveElements:function(e,t,r,n){return[n,e]},resizerType:"dynamic"};!function(){q=d({constructor:function(t,r,n,i){var o=this;if(this.overflow=i.overflow||"auto",this.element=t,this.blocks=new Array(n.length),n.length!==r.length)throw Error("Element-Meta mismatch");t.nodeType===e.Node.DOCUMENT_FRAGMENT_NODE&&(this.element=null),n.forEach(function(e,t){var i=r[t],s=n[t],l=new o.Block(i,s),a=l.size.type;"flex"===a&&o.flexCount++,"auto"===a&&o.autoCount++,o.blocks[t]=l})},name:"Width|Height",css:"width|height",element:null,size:0,sizeGetter:"offsetSize",flexCount:0,autoCount:0,reflowRequired:!0,Block:null,checkReflowRequired:function(){var e=this[this.sizeGetter]();return 0===this.autoCount&&e===this.size?!1:(this.size=e,this.reflowRequired=!0,!0)},ensureElement:function(){null==this.element&&(this.element=this.blocks[0].element.parentNode)},reflow:function(){if(this.reflowRequired===!0){var e=this.processReflow_();this.reflowRequired=!1,"visible"===this.overflow&&this.size<e&&(this.size=Math.ceil(e),this.element.style[this.css]=this.size+"px")}},processReflow_:function(){var e,t,r,n,i,o,s,l=this.size,a=0,u=0,f=this.flexCount,h=0,c=this.blocks.length;for(t=0,n=0;c>t&&(r=this.blocks[t],r.isFlex()!==!0);t++)s=r.ensureStrict(this,t,l,n,"before"),a+=s,n+=s;for(e=t,i=n,t=c-1,n=0;t>e&&(r=this.blocks[t],r.isFlex()!==!0);t--)s=r.ensureStrict(this,t,l,n,"after"),a+=s,n+=s;for(c=++t,o=n,h=Math.round((l-a)/f),t=e,n=i;c>t;t++)if(r=this.blocks[t],r.isFlex()!==!1){var p=r.ensureFlex(h,this,t,l,i,o);s=h+p,u+=s,n+=s}else console.error("<strict block size in the middle>");return u+a},offsetSize:function(){return this.element["offset"+this.name]},scrollSize:function(){return this.element["scroll"+this.name]},dispose:function(){this.element=null,this.blocks.forEach(function(e){return e.dispose()})}})}();var T,L,O;!function(){T=d(C,{name:"Width",css:"width",cssBefore:"left",cssAfter:"right"}),L=d(T,A,null),O=d(T,S,null)}();var D;!function(){D=d(q,{name:"Width",css:"width",Block:T})}();var W;!function(){W=d(q,{name:"Width",css:"width",Block:L})}();var I;!function(){I=d(q,{name:"Width",css:"width",Block:O})}();var $,G,P;!function(){$=d(F,{name:"Width",css:"width",cssBefore:"left",cssAfter:"right"}),G=d($,E,null),P=d($,R,{cssMargin:"margin-left"})}(),t.registerHandler("l:rows",Compo({tagName:"div",attr:{"class":"-l-rows"},slots:{resize:"reflow_",domInsert:"reflow_"},flexContainer_:null,constructor:function(){this.reflow_=this.reflow_.bind(this)},renderStart:function(){var e=FlexContainerCols.prepairMask(this.nodes);this.scope={$rows:e}},renderEnd:function(e){var t=e[0],r=Array.prototype.slice.call(t.childNodes);this.flexContainer_=new FlexContainerRows(t,r,this.scope.$rows,this.attr),B.bind(this.reflow_)},reflow_:function(){this.flexContainer_.reflow()},dispose:function(){this.flexContainer_.dispose(),B.unbind(this.reflow_)}})),t.registerHandler("l:cols:absolute",Compo(M,{attr:{"class":"-l-rows __absolute",style:"position: relative; width: 100%; height: 100%;"},resizerType:"once",type:"width",prepairBlocks_:function(){N.wrapFlexBlocks(this.nodes,"width","left",{bottom:"0px",top:"0px",position:"absolute"});var e=F.prepairBlockMetas(this.nodes,"width",{position:"absolute",top:"0px",height:"100%"}),t=new G(this.nodes,e,this.attr,this.expression);return t.requiresDomController()===!0?e:(t.performLayout(),null)},LayoutController:W}));var U=Compo(M,H,{compoName:"l:cols:fluid",attr:{"class":"-l-cols __fluid",style:"position: relative; width: 100%; min-height: 100%; vertical-align: top"},type:"width",prepairBlocks_:function(){N.wrapBefore(this.nodes,"width",{position:"relative",height:"100%",display:"inline-block","vertical-align":"top"}),N.wrapAfter(this.nodes,"width",{display:"inline-block",height:"100%","vertical-align":"top"}),N.wrapFlexBlocks(this.nodes,"width",null,null,{height:"100%","min-width":"100%","box-sizing":"border-box","-moz-box-sizing":"border-box",display:"inline-block","vertical-align":"top"});var e=F.prepairBlockMetas(this.nodes,"width"),t=new P(this.nodes,e,this.attr,this.expression);return t.requiresDomController()===!0?e:(t.performLayout(),null)},LayoutController:I});t.registerHandler("l:cols:fluid",U),t.registerHandler("l:cols:flex",Compo(M,{compoName:"l:cols:flex",attr:{"class":"-l-cols __flex",style:"position: relative;"+b("row"),overflow:"scroll"},resizerType:"none",type:"width",constructor:function(e,t,r,n){return x(r)===!1?new U:void(f(n)&&(u(n,b("row")),this.tagName=null))},prepairBlocks_:function(){return c(this.nodes,function(e){var t=w(e,"width");"flex"===t.size&&l(e,k())}),null}}));var V,j,J;!function(){V=d(C,{name:"Height",css:"height",cssBefore:"top",cssAfter:"bottom"}),j=d(V,A,null),J=d(V,S,null)}();var K;!function(){K=d(q,{name:"Height",css:"height",Block:V})}();var Q;!function(){Q=d(q,{name:"Height",css:"height",Block:j})}();var X;!function(){X=d(q,{name:"Height",css:"height",Block:J})}();var Y,Z,ee;!function(){Y=d(F,{name:"Height",css:"height",cssBefore:"top",cssAfter:"bottom"}),Z=d(Y,E,null),ee=d(Y,R,{cssMargin:"margin-top"})}(),t.registerHandler("l:rows",Compo({tagName:"div",attr:{"class":"-l-rows"},slots:{resize:"reflow_",domInsert:"reflow_"},flexContainer_:null,constructor:function(){this.reflow_=this.reflow_.bind(this)},renderStart:function(){var e=FlexContainerRows.prepairMask(this.nodes);this.scope={$rows:e}},renderEnd:function(e){var t=e[0],r=Array.prototype.slice.call(t.childNodes);this.flexContainer_=new FlexContainerRows(t,r,this.scope.$rows,this.attr),B.bind(this.reflow_)},reflow_:function(){this.flexContainer_.reflow()},dispose:function(){this.flexContainer_.dispose(),B.unbind(this.reflow_)}})),t.registerHandler("l:rows:absolute",Compo(M,{compoName:"l:rows:absolute",attr:{"class":"-l-rows __absolute",style:"position: relative; width: 100%;"},resizerType:"once",type:"height",prepairBlocks_:function(){N.wrapFlexBlocks(this.nodes,"height","top",{left:"0px",right:"0px",position:"absolute"});var e=F.prepairBlockMetas(this.nodes,"height",{position:"absolute",left:"0px",width:"100%"}),t=new Z(this.nodes,e,this.attr,this.expression);return t.requiresDomController()===!0?e:(t.performLayout(),null)},LayoutController:Q}));var te=Compo(M,H,{compoName:"l:rows:fluid",attr:{"class":"-l-rows __fluid"},type:"height",prepairBlocks_:function(){var e=N.wrapBefore(this.nodes,"height",{position:"relative"}),t=N.wrapAfter(this.nodes,"height");null!=e||null!=t?N.wrapFlexBlocks(this.nodes,"height",null,null,p("visible"===this.attr.overflow?{"min-height":"100%"}:{height:"100%"},i)):N.shareSpace(this.nodes,"height");var r=F.prepairBlockMetas(this.nodes,"height"),n=new ee(this.nodes,r,this.attr,this.expression);return n.requiresDomController()===!0?r:(n.performLayout(),null)},LayoutController:X});t.registerHandler("l:rows:fluid",te),t.registerHandler("l:rows:flex",Compo(M,{compoName:"l:rows:flex",attr:{"class":"-l-rows __flex",style:"position: relative;"+b("column"),overflow:"scroll"},resizerType:"none",type:"height",constructor:function(e,t,r,n){return x(r)===!1?new te:void(f(n)&&(u(n,b("column")),this.tagName=null))},prepairBlocks_:function(){return c(this.nodes,function(e){var t=w(e,"height");"flex"===t.size&&l(e,k())}),null}}))});
//# sourceMappingURL=layout.min.js.map