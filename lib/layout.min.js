!function(e,t){var r="undefined"!=typeof global?global:window,n=r.mask||r.atma&&r.atma.mask;if(null==n)throw Error("MaskJS was not loaded");t(r,n)}(this,function(e,t){"use strict";var r,n=function(e){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){return e.setTimeout(t,1e3/60)}}(e),i={"-moz-box-sizing":"border-box","box-sizing":"border-box"};!function(){r=function(e){throw new Error("[Layout Component] "+e)}}();var s,o,l;!function(){function e(e,t,r){return null==r||""===r?e:(e||"")+";"+t+":"+r}s=function(e,r){return{tagName:"div",type:t.Dom.NODE,nodes:e,attr:r}},o=function(t,r,n){if(null!=r){var i=t.attr.style;if("string"==typeof r)i=e(i,r,n);else for(var s in r)i=e(i,s,r[s]);t.attr.style=i}},l=function(e,t){var r=e.attr.style;e.attr.style=(r||"")+";"+t}}();var a;!function(){function e(e,t,r){null!=r&&e.style.setProperty(t,r)}a=function(t,r,n){if(null!=r){if("string"==typeof r)return void e(t,r,n);for(var i in r)e(t,i,r[i])}}}();var u,f;!function(){u=function(e,t){if(null==e||"object"!=typeof e)return[];if("number"!=typeof e.length)return[t(e,0)];for(var r=e.length,n=0,i=new Array(r);r>n;n++)i[n]=t(e[n],n);return i},f=function(e,t){for(var r=e.length,n=0;r>n;n++)t(e[n],n)}}();var h;!function(){h=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];null==e&&(e={});for(var n,i=t.length,s=0;i>s;s++)if(n=t[s],null!=n)for(var o in n)e[o]=n[o];return e}}();var c;!function(){c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.pop();null==r&&(r={});for(var n,i,s,o=r.hasOwnProperty("constructor")?r.constructor:null,l=e.length;--l>-1;){i=e[l],"function"==typeof i&&(null==o&&null==n&&(n=i),i=i.prototype);for(var a in i)null==r[a]&&(r[a]=i[a]);null==s&&(s=i)}return r.Parent=s,null==o&&(o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n?n.apply(this,e):void 0}),o.prototype=r,o}}();var p,d,v;!function(){p=function(e,t,r,n,i){for(3===arguments.length&&(n=0,i=e.length);i>n;n++){var s=B.parseType(e[n].attr[t]);if(s===r)return!0}return!1},d=function(e,t,r,n){2===arguments.length&&(r=0,n=e.length);var i,o,l;for(i=r;n>i;i++)if(l=new B(e[i].attr[t]),null!=o){if(o.type!==l.type){o.type="auto";break}o.value+=l.value}else o=l;var a=s(e.slice(r,n),{});return a.attr[t]=String(o),a},v=function(e,t,r){var n=e.attr,i=n[t],s=n["min-"+t],l=n["max-"+t],a=n.overflow;return"flex"!==i&&o(e,t,i),o(e,"min-"+t,s),o(e,"max-"+t,l),o(e,"overflow",a),o(e,r),null!=i&&(n[t]=null),null!=s&&(n["min-"+t]=null),null!=l&&(n["max-"+t]=null),null!=a&&(n.overflow=null),null==i&&(i="flex"),{size:i,min:s,max:l,overflow:a}}}();var m,w;!function(){function e(e){var n;if(!e)return r;for(var i,s,o,l,a=t.length,u=0;a>u;u++)if(n=t[u],i=n[0],s=n[1],l=n[2],n,-1!==e.indexOf(i)){if(null==l)return{browser:s};var f=l.exec(e);return f&&f.length>1&&(o=parseFloat(f[1])),{browser:s,version:o||0}}return r}m=function(t){var r=t&&t.req&&t.req.headers?t.req.headers["User-Agent"]:navigator.userAgent;return e(r)},w=e;var t=[["bot","bot"],["Opera","opera",/Version\/? ?(\d+(\.\d+)*)/],["MSIE","ie",/MSIE (\d+(\.\d+)*)/],["Android","android",/Android ?(\d+(\.\d+)*)/],["BlackBerry","blackberry",/Version\/? ?(\d+(\.\d+)*)/],["Firefox","firefox",/Firefox\/(\d+(\.\d+)*)/],["Chrome","chrome",/Chrome\/(\d+(\.\d+)*)/],["Safari","safari",/Version\/(\d+(\.\d+)*)/],["rv:","ie",/rv:(\d+(\.\d+)*)/]],r={browser:"unknown",version:0}}();var g,y,x,b;!function(){g=function(t){var r=m(t),n=e[r.browser];return n===!0?!0:n<=r.version},y=function(){var e=void 0!==arguments[0]?arguments[0]:"row";return"display: -webkit-flex; display: flex; -webkit-flex-direction: "+e+"; flex-direction: "+e},x=function(){var e=void 0!==arguments[0]?arguments[0]:1;return"-webkit-flex: "+e+"; flex: "+e},b=function(e,t){var r=e,n={};return"visible"===t&&(r="min-"+r),n[r]="100%",n};var e={bot:!0,ie:11,firefox:28,chrome:21,safari:7,opera:12.1,blackberry:10,android:4.4}}();var k;!function(){function e(){var e,r=t.length;for(e=0;r>e;e++)t[e].checkReflowRequired();for(e=0;r>e;e++)t[e].reflow()}var t=[];k={register:function(e){null!=e&&(t.unshift(e),r())},unregister:function(e){if(null!=e){var r=listeners_.indexOf(e);-1!==r&&t.splice(r,1)}}};var r;!function(){function t(){i||(i=!0,n(function(){i=!1,e()}))}r=function(){r=function(){},window.addEventListener("resize",t,!1)};var i=!1}()}(),function(){function e(e,t,r){return null==r?s(t,{style:e}):(r.style=r.style?r.style+";"+e:e,s(t,r))}t.registerHandler("l:center",{renderStart:function(){this.nodes=e("display: table; min-height: 100%; width: 100%; overflow: auto",e("display: table-cell; vertical-align: middle",e("margin: 0 auto",this.nodes,this.attr)))}})}();var B;!function(){B=function(e){this.type=B.parseType(e),("px"===this.type||"%"===this.type)&&(this.value=parseFloat(e))},B.prototype={type:"flex|auto|px|%",value:null,toString:function(){switch(this.type){case"px":case"%":return this.value+this.type;case"auto":return"auto";default:return null}}},B.parseType=function(e){return null==e||"flex"===e?"flex":"auto"===e?e:-1!==e.indexOf("px")?"px":-1!==e.indexOf("%")?"%":void r("Invalid size value "+e)}}();var z,_,C;!function(){z=function(e,t){this.size=new B(t.size),this.overflow=t.overflow,this.element=e},z.prototype={element:null,name:"Width|Height",css:"width|height",overflow:"auto|scroll|visible",size:null,offsetBefore:null,offsetAfter:null,isFlex:function(){return"flex"===this.size.type},ensureStrict:function(e,t,r,n){this.offsetBefore=n;var i=this.size.value;switch(this.size.type){case"px":return i;case"%":return r*i/100;case"auto":return null==i&&(i=this.size.value=this.offsetSize()),i}throw Error("Unsupported type: "+this.size.type)},ensureFlex:function(e,t,r,n,i){if(this.offsetBefore=i,"visible"!==this.overflow)return this.size.value=e,this.element.style[this.css]=e+"px",0;this.size.value=e,this.element.style["min-height"]=e+"px";var s=this.offsetSize()-e;return 0>s?0:s},dispose:function(){this.element=null},offsetSize:function(){return this.element["offset"+this.name]},scrollSize:function(){return this.element["scroll"+this.name]},setCss:function(e,t){return a(this.element,e,t),this}},_={ensureStrict:function(e,t,r,n,i){var s="before"===i?this.cssBefore:this.cssAfter;return n!==this.offsetBefore&&(this.element.style[s]=n+"px"),z.prototype.ensureStrict.call(this,e,t,r,n)},ensureFlex:function(e,t,r,n,i,s){var o=this.element.style;return i!==this.offsetBefore&&(o[this.cssBefore]=(this.offsetBefore=i)+"px"),s!==this.offsetAfter&&(o[this.cssAfter]=(this.offsetAfter=s)+"px"),s-i}},C={ensureStrict:function(e,t,r,n,i){if("after"===i){var s=this.element["offset"+this.name];a(this.element,"margin-"+this.cssBefore,"-"+s+"px")}return z.prototype.ensureStrict.call(this,e,t,r,n)},ensureFlex:function(e,t,r,n,i,s){return this.offsetBefore!==i&&((null!=this.offsetBefore||0!==i)&&this.setCss("margin-"+this.cssBefore,"-"+i+"px").setCss("padding-"+this.cssBefore,i+"px"),this.offsetBefore=i),this.offsetAfter!==s&&((null!=this.offsetAfter||0!==s)&&this.setCss("padding-"+this.cssAfter,s+"px"),this.offsetAfter=s),s-i}}}();var A,S,F;!function(){A=c({constructor:function(e,t){this.nodes=e,this.metas=t},beforeCount:0,afterCount:0,performLayout:function(){for(var e,t=this.metas.length,r={before:{value:0,unit:"px"},after:{value:0,unit:"px"}},n=null,i="before",s=0;t>s;s++)if(e=new B(this.metas[s].size),"flex"!==e.type){this[i+"Count"]+=1;var o=r[i];this.setStrict(this.nodes[s],this.metas[s],o.value+o.unit,i),o.unit=e.type,o.value+=e.value}else n=s,i="after";this.setFlex(this.nodes[n],this.metas[n],r.before.value+r.before.unit,r.after.value+r.after.unit)},requiresDomController:function(){for(var e,t=this.metas.length,r=0,n="before",i=null;t>r;r++)if(e=B.parseType(this.metas[r].size),"flex"!==e){if("auto"===e)return!0;if(null!=i){if(i!==e)return!0}else i=e}else{if("after"===n)return!0;n="after",i=null}return!1},nodes:null,metas:null}),A.prepairBlockMetas=function(e,t,r){return u(e,function(e){return v(e,t,r)})},S=c(A,{cssBefore:null,cssAfter:null,setStrict:function(e,t,r,n){var i="before"===n?this.cssBefore:this.cssAfter;o(e,i,r)},setFlex:function(e,t,r,n){var i={};i[this.cssBefore]=r,i[this.cssAfter]=n,o(e,i)}}),F=c(A,{cssMargin:"margin-top|margin-left",setStrict:function(e,t,r,n){"after"===n&&(o(e,this.css,t.size),o(e,this.cssMargin,"-"+t.size))},setFlex:function(e,t,r,n){var i={};0!==this.beforeCount&&(i["margin-"+this.cssBefore]="-"+r,i["padding-"+this.cssBefore]=r),0!==this.afterCount&&(i["padding-"+this.cssAfter]=n),o(e,i)}})}();var E;!function(){function e(e,t){var r=e.attr[t];return null==r||"flex"===r}function t(e,t,r,n,i){var s=d(e,t,r,n);return f(s.nodes,function(e){return v(e,t)}),o(s,i),e.splice(r,n-r,s),s}function r(e,t,r,n,i){var s=n-r;if(0===s)return null;var l=e[r];return o(l,i),l}E={wrapFlexBlocks:function(t,n,i,l,a){var u,f,h,c=t.length;for(u=0;c>u&&!e(t[u],n);u++);for(f=u,u=c-1;u>f&&!e(t[u],n);u--);h=++u;var p=null,d=h-f;return 2>d?r(t,n,f,h,a):(p=s(t.splice(f,d),{}),this.shareSpace(p.nodes,n,i,l),o(p,a),t.splice(f,0,p),p)},wrapBefore:function(n,i,s){var o,l=n.length;for(o=0;l>o&&!e(n[o],i);o++);return 2>o?r(n,i,0,o,s):(l=o,t(n,i,0,l,s))},wrapAfter:function(n,i,s){var o,l=n.length;for(o=l-1;o>-1&&!e(n[o],i);o--);return o>=l-2?r(n,i,o+1,l,s):t(n,i,o+1,l,s)},shareSpace:function(e,t,r,n){var i=0,s=100/e.length;f(e,function(e){var a=t;"visible"===e.attr.overflow?a="min-"+a:l(e,"overflow: auto"),o(e,a,s+"%"),o(e,r,i+"%"),o(e,n),i+=s})}}}();var R,q={tagName:"div",type:"width|height",layout:null,resizerType:"dynamic",meta:{mode:"server"},attr:{overflow:"auto"},slots:{domInsert:function(){null!=this.layout&&(this.layout.checkReflowRequired(),this.layout.reflow())},layout_Recalculate:function(){return this.layout.checkReflowRequired()},layout_Reflow:function(){this.layout.reflow()}},renderStart:function(){this.handleAttr_(),this.handleExpression_();var e=this.prepairBlocks_();null==e?this.slots=null:this.scope={$blocks:e}},renderEnd:function(e,t,r,n){var i=this.scope&&this.scope.$blocks;if(null!=i){var s=this.resolveElements(e,t,r,n),o=s[0],l=s[1];this.layout=new this.LayoutController(o,l,i,this.attr),"dynamic"===this.resizerType&&k.register(this.layout)}},resolveElements:function(e,t,r,n){var n=e[0],i=Array.prototype.slice.call(n.childNodes);return[n,i]},dispose:function(){null!=this.layout&&(this.layout.dispose(),k.unregister(this.layout))},handleExpression_:function(){if(null!=this.expression){var e=this,t=e.nodes,r=e.type,n=e.expression,i=n.split(-1===n.indexOf(",")?" ":",");if(i.length!==t.length)throw Error("Expression for "+i.length+", but expected for "+t.length+" elements. "+n);f(t,function(e,t){return e.attr[r]=i[t].trim()})}},handleAttr_:function(){var e="width: 100%",t="height: 100%";"visible"===this.attr.overflow&&(e="min-"+e,t="min-"+t),l(this,e+";"+t)}},M={attr:{style:"position: relative;",overflow:"visible"},handleAttr_:function(){this.tagName=null},resolveElements:function(e,t,r,n){return[n,e]},resizerType:"once"};!function(){R=c({constructor:function(e,t,r,n){var i=this;if(this.overflow=n.overflow||"auto",this.element=e,this.blocks=new Array(r.length),r.length!==t.length)throw Error("Element-Meta mismatch");r.forEach(function(e,n){var s=t[n],o=r[n],l=new i.Block(s,o);l.isFlex()&&i.flexCount++,i.blocks[n]=l})},name:"Width|Height",css:"width|height",element:null,size:0,sizeGetter:"offsetSize",flexCount:0,reflowRequired:!0,Block:null,checkReflowRequired:function(){var e=this[this.sizeGetter]();return e===this.size?!1:(this.size=e,this.reflowRequired=!0,!0)},reflow:function(){if(this.reflowRequired===!0){var e=this.processReflow_();this.reflowRequired=!1,"visible"===this.overflow&&this.size<e&&(this.size=Math.ceil(e),this.element.style[this.css]=this.size+"px")}},processReflow_:function(){var e,t,r,n,i,s,o,l=this.size,a=0,u=0,f=this.flexCount,h=0,c=this.blocks.length;for(t=0,n=0;c>t&&(r=this.blocks[t],r.isFlex()!==!0);t++)o=r.ensureStrict(this,t,l,n,"before"),a+=o,n+=o;for(e=t,i=n,t=c-1,n=0;t>e&&(r=this.blocks[t],r.isFlex()!==!0);t--)o=r.ensureStrict(this,t,l,n,"after"),a+=o,n+=o;for(c=++t,s=n,h=Math.round((l-a)/f),t=e,n=i;c>t;t++)if(r=this.blocks[t],r.isFlex()!==!1){var p=r.ensureFlex(h,this,t,l,i,s);o=h+p,u+=o,n+=o}else console.error("<strict block size in the middle>");return u+a},offsetSize:function(){return this.element["offset"+this.name]},scrollSize:function(){return this.element["scroll"+this.name]},dispose:function(){this.element=null,this.blocks.forEach(function(e){return e.dispose()})}})}();var H,N,L;!function(){H=c(z,{name:"Width",css:"width",cssBefore:"left",cssAfter:"right"}),N=c(H,_,null),L=c(H,C,null)}();var T;!function(){T=c(R,{name:"Width",css:"width",Block:H})}();var O;!function(){O=c(R,{name:"Width",css:"width",Block:N})}();var D;!function(){D=c(R,{name:"Width",css:"width",Block:L})}();var W,I,$;!function(){W=c(A,{name:"Width",css:"width",cssBefore:"left",cssAfter:"right"}),I=c(W,S,null),$=c(W,F,{cssMargin:"margin-left"})}(),t.registerHandler("l:rows",Compo({tagName:"div",attr:{"class":"-l-rows"},slots:{resize:"reflow_",domInsert:"reflow_"},flexContainer_:null,constructor:function(){this.reflow_=this.reflow_.bind(this)},renderStart:function(){var e=FlexContainerCols.prepairMask(this.nodes);this.scope={$rows:e}},renderEnd:function(e){var t=e[0],r=Array.prototype.slice.call(t.childNodes);this.flexContainer_=new FlexContainerRows(t,r,this.scope.$rows,this.attr),k.bind(this.reflow_)},reflow_:function(){this.flexContainer_.reflow()},dispose:function(){this.flexContainer_.dispose(),k.unbind(this.reflow_)}})),t.registerHandler("l:cols:absolute",Compo(q,{attr:{"class":"-l-rows __absolute",style:"position: relative; width: 100%; height: 100%;"},resizerType:"once",type:"width",prepairBlocks_:function(){E.wrapFlexBlocks(this.nodes,"width","left",{bottom:"0px",top:"0px",position:"absolute"});var e=A.prepairBlockMetas(this.nodes,"width",{position:"absolute",top:"0px",height:"100%"}),t=new I(this.nodes,e,this.attr,this.expression);return t.requiresDomController()===!0?e:(t.performLayout(),null)},LayoutController:O}));var P=Compo(q,M,{compoName:"l:cols:fluid",attr:{"class":"-l-cols __fluid",style:"position: relative; width: 100%; min-height: 100%; vertical-align: top"},type:"width",prepairBlocks_:function(){E.wrapBefore(this.nodes,"width",{position:"relative",height:"100%",display:"inline-block","vertical-align":"top"}),E.wrapAfter(this.nodes,"width",{display:"inline-block",height:"100%","vertical-align":"top"}),E.wrapFlexBlocks(this.nodes,"width",null,null,{height:"100%","min-width":"100%","box-sizing":"border-box","-moz-box-sizing":"border-box",display:"inline-block","vertical-align":"top"});var e=A.prepairBlockMetas(this.nodes,"width"),t=new $(this.nodes,e,this.attr,this.expression);return t.requiresDomController()===!0?e:(t.performLayout(),null)},LayoutController:D});t.registerHandler("l:cols:fluid",P),t.registerHandler("l:cols:flex",Compo(q,M,{compoName:"l:cols:flex",attr:{"class":"-l-cols __flex",style:"position: relative;"+y("row"),overflow:"visible"},resizerType:"none",type:"width",constructor:function(e,t,r){return g(r)===!1?new P:void 0},prepairBlocks_:function(){return f(this.nodes,function(e){var t=v(e,"width");"flex"===t.size&&l(e,x())}),null}}));var V,G,U;!function(){V=c(z,{name:"Height",css:"height",cssBefore:"top",cssAfter:"bottom"}),G=c(V,_,null),U=c(V,C,null)}();var j;!function(){j=c(R,{name:"Height",css:"height",Block:V})}();var J;!function(){J=c(R,{name:"Height",css:"height",Block:G})}();var K;!function(){K=c(R,{name:"Height",css:"height",Block:U})}();var Q,X,Y;!function(){Q=c(A,{name:"Height",css:"height",cssBefore:"top",cssAfter:"bottom"}),X=c(Q,S,null),Y=c(Q,F,{cssMargin:"margin-top"})}(),t.registerHandler("l:rows",Compo({tagName:"div",attr:{"class":"-l-rows"},slots:{resize:"reflow_",domInsert:"reflow_"},flexContainer_:null,constructor:function(){this.reflow_=this.reflow_.bind(this)},renderStart:function(){var e=FlexContainerRows.prepairMask(this.nodes);this.scope={$rows:e}},renderEnd:function(e){var t=e[0],r=Array.prototype.slice.call(t.childNodes);this.flexContainer_=new FlexContainerRows(t,r,this.scope.$rows,this.attr),k.bind(this.reflow_)},reflow_:function(){this.flexContainer_.reflow()},dispose:function(){this.flexContainer_.dispose(),k.unbind(this.reflow_)}})),t.registerHandler("l:rows:absolute",Compo(q,{compoName:"l:rows:absolute",attr:{"class":"-l-rows __absolute",style:"position: relative; width: 100%;"},resizerType:"once",type:"height",prepairBlocks_:function(){E.wrapFlexBlocks(this.nodes,"height","top",{left:"0px",right:"0px",position:"absolute"});var e=A.prepairBlockMetas(this.nodes,"height",{position:"absolute",left:"0px",width:"100%"}),t=new X(this.nodes,e,this.attr,this.expression);return t.requiresDomController()===!0?e:(t.performLayout(),null)},LayoutController:J}));var Z=Compo(q,M,{compoName:"l:rows:fluid",attr:{"class":"-l-rows __fluid"},type:"height",prepairBlocks_:function(){var e=E.wrapBefore(this.nodes,"height",{position:"relative"}),t=E.wrapAfter(this.nodes,"height");null!=e||null!=t?E.wrapFlexBlocks(this.nodes,"height",null,null,h("visible"===this.attr.overflow?{"min-height":"100%"}:{height:"100%"},i)):E.shareSpace(this.nodes,"height");var r=A.prepairBlockMetas(this.nodes,"height"),n=new Y(this.nodes,r,this.attr,this.expression);return n.requiresDomController()===!0?r:(n.performLayout(),null)},LayoutController:K});t.registerHandler("l:rows:fluid",Z),t.registerHandler("l:rows:flex",Compo(q,M,{compoName:"l:rows:flex",attr:{"class":"-l-rows __flex",style:"position: relative;"+y("column")},resizerType:"none",type:"height",constructor:function(e,t,r){return g(r)===!1?new Z:void 0},prepairBlocks_:function(){return f(this.nodes,function(e){var t=v(e,"height");"flex"===t.size&&l(e,x())}),null}}))});
//# sourceMappingURL=layout.min.js.map